{% extends 'treeapp/base.html' %}
{% load static %}



{% block content %}
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Devanagari:wght@500;700&family=Poppins:wght@500;700&display=swap" rel="stylesheet">
<style>
.site-title {
    background: linear-gradient(135deg, #6a11cb, #2575fc);
    color: white;
    text-align: center;
    padding: 15px 10px;
    font-family: 'Noto Sans Devanagari', 'Segoe UI', sans-serif;
    font-size: 1.8rem;
    font-weight: 700;
    margin: 0;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
}

.feature-cards {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 20px;
    margin: 40px auto;
    max-width: 1200px;
}

.feature-card {
    flex: 1;
    min-width: 280px;
    max-width: 380px;
    background: white;
    border-radius: 15px;
    overflow: hidden;
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.08);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.feature-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 15px 35px rgba(0, 0, 0, 0.12);
}

.feature-card-header {
    padding: 20px;
    background: linear-gradient(135deg, #6a11cb, #2575fc);
    color: white;
    text-align: center;
}

.feature-card-header.tree {
    background: linear-gradient(135deg, #43a047, #7cb342);
}

.feature-card-header.gallery {
    background: linear-gradient(135deg, #1976d2, #64b5f6);
}

.feature-card-header.help {
    background: linear-gradient(135deg, #ff9800, #ffb74d);
}

.feature-card-header.post {
    background: linear-gradient(135deg, #9c27b0, #ba68c8);
}

.feature-card-header.blood {
    background: linear-gradient(135deg, #e74c3c, #ff7675);
}

.feature-card-header.donate {
    background: linear-gradient(135deg, #2ecc71, #27ae60);
}

.feature-icon {
    font-size: 3rem;
    margin-bottom: 10px;
}

.card-content-wrapper {
    display: flex;
    flex-direction: column;
}

.card-image {
    overflow: hidden;
    border-radius: 8px;
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
}

.card-buttons {
    display: flex;
    justify-content: center;
    gap: 10px;
    margin-top: 15px;
}

.feature-card-header h3 {
    margin: 0;
    font-size: 1.5rem;
    font-weight: 600;
}

.feature-card-body {
    padding: 20px;
    text-align: center;
}

.feature-card-body p {
    color: #555;
    line-height: 1.6;
    margin-bottom: 20px;
}

.feature-btn {
    display: inline-block;
    padding: 10px 20px;
    background: #6a11cb;
    color: white;
    text-decoration: none;
    border-radius: 30px;
    font-weight: 600;
    transition: background 0.3s ease;
}

.feature-btn.tree {
    background: #43a047;
}

.feature-btn.gallery {
    background: #1976d2;
}

.feature-btn.help {
    background: #ff9800;
}

.feature-btn.post {
    background: #9c27b0;
}

.feature-btn.blood {
    background: #e74c3c;
}

.feature-btn.donate {
    background: #2ecc71;
}

.feature-btn:hover {
    opacity: 0.9;
    transform: translateY(-2px);
}

.admin-btn {
    display: inline-block;
    padding: 12px 24px;
    background: linear-gradient(135deg, #4a6bff, #6c5ce7);
    color: white;
    text-decoration: none;
    border-radius: 8px;
    font-weight: 600;
    font-size: 1rem;
    box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    transition: all 0.3s ease;
    border: none;
    cursor: pointer;
    margin: 2.2em 0;
}

.admin-btn:hover {
    transform: translateY(-3px);
    box-shadow: 0 6px 15px rgba(0,0,0,0.15);
}

.admin-btn-icon {
    margin-right: 8px;
    font-size: 1.2rem;
}

@media (max-width: 768px) {
    .feature-card {
        min-width: 100%;
    }
    
    .site-title {
        font-size: 1.4rem;
        padding: 12px 5px;
    }
}

@media (max-width: 480px) {
    .site-title {
        font-size: 1.1rem;
    }
}
</style>

{% if user.is_staff %}
  <div style="text-align:center;">
    <a href="{% url 'add_multiple_children' %}" class="admin-btn">
      <span class="admin-btn-icon">‚ûï</span> Add Multiple Family Members
    </a>
  </div>
{% endif %}

{% if messages %}
  <div style="max-width:600px;margin:1.5em auto 0 auto;">
    {% for message in messages %}
      <div class="msg-{{ message.tags }}">
        {{ message }}
      </div>
    {% endfor %}
  </div>
{% endif %}

<!-- Main Title -->
<div class="site-title">
    ‡§µ‡§Ç‡§∂‡§æ‡§µ‡§≤‡•Ä ‡§∏‡§æ‡§∞‡§∏‡•ç‡§µ‡§§ ‡§µ‡§∂‡§ø‡§∑‡•ç‡§ü ‡§ó‡•å‡§§‡•ç‡§∞ ‡§¨‡§æ‡§Ç‡§ú‡§£‡•Ä ‡§™‡§∞‡§ø‡§µ‡§æ‡§∞
</div>

<!-- Feature Cards: All in one container for 4 in a row on desktop -->
<div class="feature-cards">
    <div class="feature-card">
        <div class="feature-card-header tree">
            <div class="feature-icon">üå≤</div>
            <h3>Family Tree</h3>
        </div>
        <div class="feature-card-body">
            <div class="card-content-wrapper">
                <div class="card-image">
                    <img src="{% static 'treeapp/images/tree.jpg' %}" alt="Family Tree" style="width: 100%; border-radius: 8px; margin-bottom: 15px;">
                </div>
                <p>Explore your family's ancestry and lineage with our interactive family tree visualization.</p>
                <a href="{% url 'tree' %}?style=1" class="feature-btn tree">View Tree</a>
            </div>
        </div>
    </div>
    <div class="feature-card">
        <div class="feature-card-header gallery">
            <div class="feature-icon">üñºÔ∏è</div>
            <h3>Gallery</h3>
        </div>
        <div class="feature-card-body">
            <div class="card-content-wrapper">
                <div class="card-image">
                    <img src="{% static 'treeapp/images/image1.jpg' %}" alt="Gallery" style="width: 100%; border-radius: 8px; margin-bottom: 15px;">
                </div>
                <p>Browse photos and memories shared by family members to preserve our heritage.</p>
                <a href="{% url 'gallery' %}" class="feature-btn gallery">View Gallery</a>
            </div>
        </div>
    </div>
    <div class="feature-card">
        <div class="feature-card-header post">
            <div class="feature-icon">üìù</div>
            <h3>Posts</h3>
        </div>
        <div class="feature-card-body">
            <div class="card-content-wrapper">
                <div class="card-image">
                    <img src="{% static 'treeapp/images/post.jpg' %}" alt="Posts" style="width: 100%; border-radius: 8px; margin-bottom: 15px;">
                </div>
                <p>Read and share important announcements and updates with the community.</p>
                <a href="{% url 'posts' %}" class="feature-btn post">View Posts</a>
            </div>
        </div>
    </div>
    <div class="feature-card">
        <div class="feature-card-header blood" style="background: linear-gradient(135deg, #e53935, #ff5252);">
            <div class="feature-icon">‚ù§Ô∏è</div>
            <h3>Blood Bank Services</h3>
        </div>
        <div class="feature-card-body">
            <div class="card-content-wrapper">
                <div class="card-image">
                    <img src="{% static 'treeapp/images/blood-bank.jpg' %}" alt="Blood Donation" style="width: 100%; border-radius: 8px; margin-bottom: 15px;">
                </div>
                <p>Help save lives by donating blood or find donors when in need. Our blood bank connects family members in medical emergencies.</p>
                <div class="card-buttons">
                    <a href="{% url 'blood_donor' %}" class="feature-btn blood" style="margin-right: 10px; background: #e53935;">Donate</a>
                    <a href="{% url 'blood_request' %}" class="feature-btn blood" style="background: #e53935;">Request</a>
                </div>
            </div>
        </div>
    </div>
    <div class="feature-card">
        <div class="feature-card-header help" style="background: linear-gradient(135deg, #fb8c00, #ffb74d);">
            <div class="feature-icon">üìã</div>
            <h3>Instructions & Help</h3>
        </div>
        <div class="feature-card-body">
            <div class="card-content-wrapper">
                <div class="card-image">
                    <img src="{% static 'treeapp/images/help.jpg' %}" alt="Instructions" style="width: 100%; border-radius: 8px; margin-bottom: 15px;">
                </div>
                <p>New to our platform? Learn how to navigate the family tree, update your information, and use all available features.</p>
                <a href="{% url 'instructions' %}" class="feature-btn help" style="background: #fb8c00;">View Instructions</a>
            </div>
        </div>
    </div>
    <!-- New Card: Events & Announcements -->
    <div class="feature-card">
        <div class="feature-card-header event" style="background: linear-gradient(135deg, #00bcd4, #2196f3);">
            <div class="feature-icon">üìÖ</div>
            <h3>Events & Announcements</h3>
        </div>
        <div class="feature-card-body">
            <div class="card-content-wrapper">
                <div class="card-image">
                    <img src="{% static 'treeapp/images/events.jpg' %}" alt="Events" style="width: 100%; border-radius: 8px; margin-bottom: 15px;">
                </div>
                <p>Stay updated with upcoming family events, reunions, and important announcements. Never miss a moment!</p>
                <a href="{% url 'posts' %}" class="feature-btn event" style="background: #00bcd4;">View Events</a>
            </div>
        </div>
    </div>
    <div class="feature-card">
        <div class="feature-card-header donate" style="background: linear-gradient(135deg, #00c853, #69f0ae);">
            <div class="feature-icon">üíö</div>
            <h3>Donate Now</h3>
        </div>
        <div class="feature-card-body">
            <div class="card-content-wrapper">
                <div class="card-image">
                    <img src="{% static 'treeapp/images/donate.jpg' %}" alt="Donate" style="width: 100%; border-radius: 8px; margin-bottom: 15px;">
                </div>
                <p>Support our family tree project and help it grow stronger. Your contribution makes a difference.</p>
                <a href="{% url 'donation_page' %}" class="feature-btn donate" style="background: #00c853;">Donate Now</a>
            </div>
        </div>
    </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", function() {
  // Check for OTP error messages
  var otpErrorMsg = "Failed to send OTP. Please try again later.";
  var messages = document.querySelectorAll('[class^="msg-"]');
  
  messages.forEach(function(msg) {
    if (msg.textContent.trim() === otpErrorMsg) {
      // Convert regular error message to specialized OTP error
      msg.className = "msg-otp-error";
      
      // Create container for buttons
      var btnContainer = document.createElement("div");
      btnContainer.style.display = "flex";
      btnContainer.style.justifyContent = "center";
      btnContainer.style.gap = "10px";
      btnContainer.style.marginTop = "15px";
      
      // Add retry button
      var retryBtn = document.createElement("button");
      retryBtn.textContent = "Try Again";
      retryBtn.style.padding = "8px 16px";
      retryBtn.style.background = "#f44336";
      retryBtn.style.color = "white";
      retryBtn.style.border = "none";
      retryBtn.style.borderRadius = "4px";
      retryBtn.style.cursor = "pointer";
      retryBtn.style.fontWeight = "600";
      retryBtn.style.boxShadow = "0 2px 5px rgba(0,0,0,0.2)";
      
      retryBtn.addEventListener("click", function(e) {
        e.preventDefault();
        window.location.reload();
      });
      
      // Add back button
      var backBtn = document.createElement("button");
      backBtn.textContent = "Back";
      backBtn.style.padding = "8px 16px";
      backBtn.style.background = "#757575";
      backBtn.style.color = "white";
      backBtn.style.border = "none";
      backBtn.style.borderRadius = "4px";
      backBtn.style.cursor = "pointer";
      backBtn.style.fontWeight = "600";
      backBtn.style.boxShadow = "0 2px 5px rgba(0,0,0,0.2)";
      
      backBtn.addEventListener("click", function(e) {
        e.preventDefault();
        window.history.back();
      });
      
      btnContainer.appendChild(retryBtn);
      btnContainer.appendChild(backBtn);
      msg.appendChild(btnContainer);
      
      // Add shake animation
      msg.style.animation = "shake 0.82s cubic-bezier(.36,.07,.19,.97) both";
    }
  });
  
  // Hide messages after delay (except OTP errors which need user action)
  setTimeout(function(){
    var regularMsgs = document.querySelectorAll('.msg-success, .msg-info, .msg-warning');
    regularMsgs.forEach(function(msg){ msg.style.display = 'none'; });
  }, 7000);
});
</script>
{% endblock %}